<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>reporting/Report.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="BooleanCriteria.html">BooleanCriteria</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="BrowserModule.html">BrowserModule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#getBrowser">getBrowser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isChrome">isChrome</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isEdge">isEdge</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isFirefox">isFirefox</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isIE">isIE</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isIOSChrome">isIOSChrome</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BrowserModule.html#isSafari">isSafari</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CheckboxCriteria.html">CheckboxCriteria</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Consolable.html">Consolable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Consolable.html#debug">debug</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Consolable.html#error">error</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Consolable.html#log">log</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Consolable.html#warn">warn</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ConsoleModule.html">ConsoleModule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#assert">assert</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#buildArguments">buildArguments</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#countReset">countReset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#debug">debug</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#dir">dir</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#disable">disable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#enable">enable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#error">error</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#group">group</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#groupCollapsed">groupCollapsed</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#groupEnd">groupEnd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#help">help</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#info">info</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#log">log</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#profile">profile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#profileEnd">profileEnd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#setColor">setColor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#setTag">setTag</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#table">table</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#time">time</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#timeEnd">timeEnd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#timeLog">timeLog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#trace">trace</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ConsoleModule.html#warn">warn</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CriteriaControl.html">CriteriaControl</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#getInstance">getInstance</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#getIsEnabled">getIsEnabled</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#getValue">getValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#initializeJS">initializeJS</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#render">render</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CriteriaControl.html#setValue">setValue</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DataTable.html">DataTable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#buildGroupCounters">buildGroupCounters</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#closeAllGroups">closeAllGroups</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#filter">filter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#getColumn">getColumn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#getGroupBy">getGroupBy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#getLevelCount">getLevelCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#getOrderBy">getOrderBy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#hasColumn">hasColumn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#hideColumn">hideColumn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#isColumnVisible">isColumnVisible</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#postRender">postRender</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#preRender">preRender</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#render">render</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#renderGroupHeader">renderGroupHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#setColumn">setColumn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTable.html#sort">sort</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DataTableReportSection.html">DataTableReportSection</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DataTypeModule.html">DataTypeModule</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTypeModule.html#copyObjectProperties">copyObjectProperties</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTypeModule.html#parseFloat">parseFloat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataTypeModule.html#toBool">toBool</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DatePeriodCriteria.html">DatePeriodCriteria</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ExcelModule.html">ExcelModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="FormatModule.html">FormatModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ImportModule.html">ImportModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Module.html">Module</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Module.html#initialize">initialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NumericCriteria.html">NumericCriteria</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PDFModule.html">PDFModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PrintingModule.html">PrintingModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Report.html">Report</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#applyCriterias">applyCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#cancelCriterias">cancelCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#close">close</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#copyOriginalSettings">copyOriginalSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#exportReport">exportReport</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#getContainerSelector">getContainerSelector</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#getId">getId</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#getPaperSizeOptions">getPaperSizeOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#getReportDefinition">getReportDefinition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#getReportDefinitionUrl">getReportDefinitionUrl</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#hideReportCriterias">hideReportCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#loadReportDefinition">loadReportDefinition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#print">print</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#renderReportCriterias">renderReportCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#renderReportSettings">renderReportSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#resetCriterias">resetCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#setContainerSelector">setContainerSelector</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#setId">setId</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#setReportDefinitionUrl">setReportDefinitionUrl</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Report.html#showReportCriterias">showReportCriterias</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ReportCanvas.html">ReportCanvas</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportCanvas.html#render">render</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ReportSection.html">ReportSection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportSection.html#sort">sort</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ReportViewer.html">ReportViewer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#applyOptions">applyOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#applySettings">applySettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#cancelSettings">cancelSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#getContainerSelector">getContainerSelector</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#getCriteria">getCriteria</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#getCriteriaValue">getCriteriaValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#getCriteriaValues">getCriteriaValues</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#hideToolbar">hideToolbar</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#isCriteriaEnabled">isCriteriaEnabled</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#loadDefaultOptions">loadDefaultOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#refreshReport">refreshReport</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#render">render</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#renderFieldPropertiesDialog">renderFieldPropertiesDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#renderMainLayout">renderMainLayout</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#renderOptionsDialog">renderOptionsDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#renderReportCriterias">renderReportCriterias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#renderReportSettings">renderReportSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#scaleReportSections">scaleReportSections</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#setContainerSelector">setContainerSelector</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#showFieldPropertiesDialog">showFieldPropertiesDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#showNoReportAlert">showNoReportAlert</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#showReportOptions">showReportOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#showReportSettings">showReportSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#showToolbar">showToolbar</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReportViewer.html#updateCSS">updateCSS</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SelectCriteria.html">SelectCriteria</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="UIModule.html">UIModule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="WordModule.html">WordModule</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#ProxyHandler">ProxyHandler</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">reporting/Report.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * Report
 * 
 * 
 * @author Benoit Gauthier &lt;bgauthier@metadocx.com>
 * @copyright Benoit Gauthier &lt;bgauthier@metadocx.com>
 * @license https://github.com/metadocx/reporting/LICENSE.md
 */
class Report {

    constructor() {

        /**
         * Report id
         */
        this.id = null;

        /**
         * Indicates if report is loaded or not
         */
        this.isLoaded = false;

        /**
         * Element where report will be rendered
         */
        this._containerSelector = '#reporting';

        /**
         * Report definition object
         */
        this._reportDefinition = null;


        /**
         * Reference to Metadocx app
         */
        this.app = null;

        /**
         * Indicates if we rendered the report criteria html and js
         */
        this._reportCriteriasRendered = false;

        /**
         * Indicates if we rendered the report settings html and js
         */
        this._reportSettingsRendered = false;

        /**
         * Copy of initial criteria values
         */
        this._initialCriteriaValues = null;

        /**
         * Copy of initial report settings
         */
        this._initialReportSettings = null;

        /**
         * Event called when report is loaded on screen
         */
        this.onReportLoaded = null;

        /**
         * Event called when report definition file is loaded
         */
        this.onReportDefinitionFileLoaded = null;

    }

    /**
     * Set report unique id
     * @param {*} id 
     * @returns 
     */
    setId(id) {
        this.id = id;
        return this;
    }

    /**
     * Returns report unique id
     * @returns 
     */
    getId() {
        return this.id;
    }

    /**
    * Loads report definition file
    */
    loadReportDefinition(reportDefinitionUrl) {

        if (reportDefinitionUrl != undefined) {
            this._reportDefinitionUrl = reportDefinitionUrl;
        }

        console.log('Report definition file is ' + this._reportDefinitionUrl);

        if (this._reportDefinition === null) {
            $.get(this._reportDefinitionUrl, (data, status) => {
                this._reportDefinition = data;
                /**
                 * Copy Report definition options to viewer options, replaces default values
                 */
                this.app.modules.DataType.copyObjectProperties(this.getReportDefinition().options, this.app.viewer.options);

                if (this.onReportDefinitionFileLoaded) {
                    this.onReportDefinitionFileLoaded();
                }
            });
        } else {
            if (this.onReportDefinitionFileLoaded) {
                this.onReportDefinitionFileLoaded();
            }
        }

    }

    /**
     * Returns select options for paper sizes
     * @returns 
     */
    getPaperSizeOptions() {
        var s = '';
        for (var x in this.pageSizes) {
            s += '&lt;option value="' + this.pageSizes[x].name + '">' + this.pageSizes[x].name + '&lt;/option>';
        }
        return s;
    }

    /**
    * Sets container element selector
    * @param {*} sContainerSelector 
    * @returns 
    */
    setContainerSelector(sContainerSelector) {
        this._containerSelector = sContainerSelector;
        return this;
    }

    /**
     * Returns container element selector
     * @returns 
     */
    getContainerSelector() {
        return this._containerSelector;
    }

    /**
     * Report definition object
     * @returns ReportDefinition
     */
    getReportDefinition() {
        return this._reportDefinition;
    }

    /**
     * Report definition url
     * @returns Report
     */
    setReportDefinitionUrl(reportDefinitionUrl) {
        this._reportDefinitionUrl = reportDefinitionUrl;
        return this;
    }

    /**
     * Returns report file definition url
     * @returns 
     */
    getReportDefinitionUrl() {
        return this._reportDefinitionUrl;
    }

    /**
     * Prints report
     */
    print() {
        if (this.app.viewer.options.printing.method == 'browser') {
            // Use default browser print 
            window.print();
        } else if (this.app.viewer.options.printing.method == 'pdf') {
            // Export as pdf and print the pdf file
            this.app.modules.PDF.print();
        }
    }

    /**
     * Close window if window was open by script
     */
    close() {
        window.close();
    }

    /**
     * Export / Convert report to a specific format
     * @param {*} format 
     */
    exportReport(format) {
        this.app.modules[format].showExportDialog();
    }

    /**
     * Renders report settings html
     * @returns 
     */
    renderReportSettings() {

        if (this._reportSettingsRendered) {
            return;
        }

        var s = '';

        s += `&lt;div class="card">
                &lt;div class="card-header">
                    &lt;h4 class="card-title mb-0">Report properties&lt;/h4>
                &lt;/div>
                &lt;div class="card-body">     
                    &lt;div class="mb-4">
                        &lt;label class="form-label" for="reportSettingsName">Name&lt;/label>
                        &lt;input class="form-control" type="text" id="reportSettingsName" placeholder="Report name" value="${this.getReportDefinition().properties.name}">
                    &lt;/div> 
                    &lt;div class="mb-4">
                        &lt;label class="form-label" for="reportSettingsDescription">Description&lt;/label>
                        &lt;input class="form-control" type="text" id="reportSettingsDescription" placeholder="Report description" value="${this.getReportDefinition().properties.description}">                        
                    &lt;/div> 
                &lt;/div>
            &lt;/div>`;

        for (var kSection in this.getReportDefinition().sections) {
            var oSection = this.getReportDefinition().sections[kSection];
            var sReportSectionType = this.getReportDefinition().sections[kSection].type + 'ReportSection';
            var oReportSection = new window.__Metadocx[sReportSectionType](this.app, this.getReportDefinition().sections[kSection]);

            var sFields = '&lt;table id="' + oSection.id + '_fields" class="table table-condensed report-sortable">';
            sFields += '&lt;tbody>';
            for (var x in oSection.model) {

                var sFieldSelected = ' checked';
                if (!oReportSection.isColumnVisible(oSection.model[x].name)) {
                    sFieldSelected = '';
                }

                sFields += `&lt;tr data-section="${oSection.id}" data-column="${oSection.model[x].name}">
                    &lt;td style="width:30px;text-align:center;">&lt;i class="uil uil-sort fs16">&lt;/i>&lt;/td>
                    &lt;td style="width:30px;text-align:center;">&lt;input id="${oSection.id}_field_${oSection.model[x].name}" type="checkbox"${sFieldSelected}/>&lt;/td>
                    &lt;td id="${oSection.id}_label_${oSection.model[x].name}">${oSection.model[x].label}&lt;/td>
                    &lt;td style="width:150px;">
                        &lt;select id="${oSection.id}_formula_${oSection.model[x].name}" class="form-control form-control-sm" style="width:100%;">
                            &lt;option value=""${(oSection.model[x].formula == '' ? ' selected' : '')}>(None)&lt;/option>
                            &lt;option value="SUM"${(oSection.model[x].formula == 'SUM' ? ' selected' : '')}>Sum&lt;/option>
                            &lt;option value="AVG"${(oSection.model[x].formula == 'AVG' ? ' selected' : '')}>Average&lt;/option>
                            &lt;option value="MIN"${(oSection.model[x].formula == 'MIN' ? ' selected' : '')}>Min Value&lt;/option>
                            &lt;option value="MAX"${(oSection.model[x].formula == 'MAX' ? ' selected' : '')}>Max Value&lt;/option>
                            &lt;option value="COUNT"${(oSection.model[x].formula == 'COUNT' ? ' selected' : '')}>Count&lt;/option>
                        &lt;/select>
                    &lt;/td>
                    &lt;td style="width:30px;">
                        &lt;button class="btn btn-sm" onClick="Metadocx.viewer.showFieldPropertiesDialog('${oSection.id}', '${oSection.model[x].name}');">&lt;i class="uil uil-ellipsis-h fs20">&lt;/i>&lt;/button>
                    &lt;/td>
                &lt;/tr>`;
            }
            sFields += '&lt;/tbody>';
            sFields += '&lt;/table>';

            /**
             * ORDER BY 
             */
            var sOrderBy = '&lt;table id="' + oSection.id + '_orderBy" class="table table-condensed report-sortable">';
            sOrderBy += '&lt;tbody>';
            for (var x in oSection.model) {


                var oOrderBy = oReportSection.getOrderBy(oSection.model[x].name);

                var sAscSelected = '';
                var sDescSelected = '';
                var sOrderBySelected = '';
                if (oOrderBy != null) {
                    if (oOrderBy.order == 'desc') {
                        sAscSelected = '';
                        sDescSelected = ' selected';
                    } else {
                        sAscSelected = ' selected';
                        sDescSelected = '';
                    }
                    sOrderBySelected = ' checked';
                }

                sOrderBy += `&lt;tr id="${oSection.id}_orderByRow_${oSection.model[x].name}" data-section="${oSection.id}" data-column="${oSection.model[x].name}">
                                &lt;td style="width:30px;text-align:center;">&lt;i class="uil uil-sort fs16">&lt;/i>&lt;/td>
                                &lt;td style="width:30px;text-align:center;">&lt;input id="${oSection.id}_orderBy_${oSection.model[x].name}" type="checkbox"${sOrderBySelected}/>&lt;/td>
                                &lt;td>${oSection.model[x].label}&lt;/td>
                                &lt;td style="width:150px;">
                                    &lt;select id="${oSection.id}_orderByOrder_${oSection.model[x].name}" class="form-control form-control-sm" style="width:100%;">
                                        &lt;option value="asc"${sAscSelected}>Ascending&lt;/option>
                                        &lt;option value="desc"${sDescSelected}>Descending&lt;/option>                                    
                                    &lt;/select>
                                &lt;/td>
                            &lt;/tr>`;
            }
            sOrderBy += '&lt;/tbody>';
            sOrderBy += '&lt;/table>';

            /**
             * GROUP BY 
             */
            var sGroupBy = '&lt;table id="' + oSection.id + '_groupBy" class="table table-condensed report-sortable">';
            sGroupBy += '&lt;tbody>';
            for (var x in oSection.model) {

                var oGroupBy = oReportSection.getGroupBy(oSection.model[x].name);

                var sAscSelected = '';
                var sDescSelected = '';
                var sGroupBySelected = '';
                if (oGroupBy !== null) {
                    if (oGroupBy.order == 'desc') {
                        sAscSelected = '';
                        sDescSelected = ' selected';
                    } else {
                        sAscSelected = ' selected';
                        sDescSelected = '';
                    }
                    sGroupBySelected = ' checked';
                }

                sGroupBy += `&lt;tr id="${oSection.id}_groupByRow_${oSection.model[x].name}" data-section="${oSection.id}" data-column="${oSection.model[x].name}">
                                &lt;td style="width:30px;text-align:center;">&lt;i class="uil uil-sort fs16">&lt;/i>&lt;/td>
                                &lt;td style="width:30px;text-align:center;">&lt;input id="${oSection.id}_groupBy_${oSection.model[x].name}" type="checkbox"${sGroupBySelected}/>&lt;/td>
                                &lt;td>${oSection.model[x].label}&lt;/td>
                                &lt;td style="width:150px;">
                                &lt;select id="${oSection.id}_groupByOrder_${oSection.model[x].name}" class="form-control form-control-sm" style="width:100%;">
                                    &lt;option value="asc"${sAscSelected}>Ascending&lt;/option>
                                    &lt;option value="desc"${sDescSelected}>Descending&lt;/option>                                    
                                &lt;/select>&lt;/td>
                            &lt;/tr>`;
            }
            sGroupBy += '&lt;/tbody>';
            sGroupBy += '&lt;/table>';

            /**
             * Main section card
             */
            s += `&lt;div class="card">
                            &lt;div class="card-header">
                                &lt;h4 class="card-title mb-0">${oSection.properties.name}&lt;/h4>
                            &lt;/div>
                            &lt;div class="card-body">              
                                &lt;div class="accordion accordion-flush" id="reportSettingsAccordion${oSection.properties.name}">
                                    &lt;div class="accordion-item">
                                        &lt;h2 id="settingsFieldsHeader_${oSection.properties.name}" class="accordion-header">
                                            &lt;button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#settingsFieldsBody_${oSection.properties.name}" aria-expanded="false" aria-controls="flush-collapseOne">                                                                        
                                                &lt;i class="uil uil-columns fs20">&lt;/i>&amp;nbsp;Fields
                                            &lt;/button>
                                        &lt;/h2>
                                        &lt;div id="settingsFieldsBody_${oSection.properties.name}" class="accordion-collapse collapse" aria-labelledby="reportSettingsAccordion${oSection.properties.name}">
                                            &lt;div class="accordion-body">                                    
                                                ${sFields}
                                            &lt;/div>
                                        &lt;/div>
                                    &lt;/div>   
                                    
                                    &lt;div class="accordion-item">
                                        &lt;h2 id="settingsOrderByHeader_${oSection.properties.name}" class="accordion-header">
                                            &lt;button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#settingsOrderByBody_${oSection.properties.name}" aria-expanded="false" aria-controls="flush-collapseOne">                                                                        
                                                &lt;i class="uil uil-sort-amount-down fs20">&lt;/i>&amp;nbsp;Order
                                            &lt;/button>
                                        &lt;/h2>
                                        &lt;div id="settingsOrderByBody_${oSection.properties.name}" class="accordion-collapse collapse" aria-labelledby="reportSettingsAccordion${oSection.properties.name}">
                                            &lt;div class="accordion-body">                                    
                                                ${sOrderBy}
                                            &lt;/div>
                                        &lt;/div>
                                    &lt;/div>   

                                    &lt;div class="accordion-item">
                                        &lt;h2 id="settingsGroupByHeader_${oSection.properties.name}" class="accordion-header">
                                            &lt;button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#settingsGroupByBody_${oSection.properties.name}" aria-expanded="false" aria-controls="flush-collapseOne">                                                                        
                                                &lt;i class="uil uil-layer-group fs20">&lt;/i>&amp;nbsp;Groups
                                            &lt;/button>
                                        &lt;/h2>
                                        &lt;div id="settingsGroupByBody_${oSection.properties.name}" class="accordion-collapse collapse" aria-labelledby="reportSettingsAccordion${oSection.properties.name}">
                                            &lt;div class="accordion-body">                                    
                                                ${sGroupBy}                             
                                            &lt;/div>
                                        &lt;/div>
                                    &lt;/div>   
                                &lt;/div>                                                                                                             
                            &lt;/div>
                        &lt;/div>`;


        }

        s += `
        &lt;div class="float-end">
            &lt;button class="btn btn-secondary mr5" onClick="Metadocx.viewer.cancelSettings();">Cancel&lt;/button>
            &lt;button class="btn btn-primary" onClick="Metadocx.viewer.applySettings();">&lt;i class="uil uil-check fs16" style="color:#fff;">&lt;/i>&amp;nbsp;Apply Settings&lt;/button>
        &lt;/div>
       `;

        $('#' + this.id + '_reportSettingsZone').html(s);
        $('.report-sortable tbody').sortable({
            placeholder: 'ui-state-highlight',
            helper: 'clone',
            update: function (e, ui) {
                console.log(e);
                console.log(ui);
            },
        });


        for (var kSection in this.getReportDefinition().sections) {

            var oSection = this.getReportDefinition().sections[kSection];
            var oReportSection = new ReportSection(this.app, this, oSection);

            /**
             * Reorder table rows based on orderby and groupby config
             */
            var reversedKeys = Object.keys(oSection.orderBy).reverse();
            reversedKeys.forEach(key => {
                //console.log(key, oSection.orderBy[key]);                
                $('#' + oSection.id + '_orderByRow_' + oSection.orderBy[key].name).prependTo('#' + oSection.id + '_orderBy');
            });


            /**
             * Reorder table rows based on orderby and groupby config
             */
            reversedKeys = Object.keys(oSection.groupBy).reverse();
            reversedKeys.forEach(key => {
                //console.log(key, oSection.orderBy[key]);                
                $('#' + oSection.id + '_groupByRow_' + oSection.groupBy[key].name).prependTo('#' + oSection.id + '_groupBy');
            });
        }

        this._reportSettingsRendered = true;

    }

    /**
     * Renders report criteria controls HTML
     * @returns string
     */
    renderReportCriterias() {


        if (this._reportCriteriasRendered) {
            return;
        }

        // $('#criteriaDetails_Department').collapse('show')
        // $('#criteriaDetails_Department').collapse('hide')

        var sCriterias = '';
        var aCriterias = [];
        for (var x in this.getReportDefinition().criterias) {

            var oCriteria = new window.__Metadocx[this.getReportDefinition().criterias[x].type](this.app);
            oCriteria.id = this.getReportDefinition().criterias[x].id;
            oCriteria.reportCriteria = this.getReportDefinition().criterias[x];
            aCriterias.push(oCriteria);

            sCriterias += `&lt;div class="accordion-item">
                            &lt;h2 id="criteriaTitle${this.getReportDefinition().criterias[x].id}" class="accordion-header">
                                &lt;button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#criteriaDetails_${this.getReportDefinition().criterias[x].id}" aria-expanded="false" aria-controls="flush-collapseOne">
                                    &lt;div class="form-check form-switch form-switch-lg">
                                        &lt;input class="form-check-input" type="checkbox" role="switch" id="criteriaEnabled_${this.getReportDefinition().criterias[x].id}">
                                        &lt;label class="form-check-label" for="criteriaEnabled_${this.getReportDefinition().criterias[x].id}">&amp;nbsp;&lt;/label>
                                    &lt;/div>                                
                                    ${this.getReportDefinition().criterias[x].name}
                                &lt;/button>
                            &lt;/h2>
                            &lt;div id="criteriaDetails_${this.getReportDefinition().criterias[x].id}" class="accordion-collapse collapse" aria-labelledby="criteriaTitle${this.getReportDefinition().criterias[x].id}">
                                &lt;div class="accordion-body">                                    
                                    &lt;p>${this.getReportDefinition().criterias[x].description}&lt;/p>
                                    ${oCriteria.render()}                                    
                                &lt;/div>
                            &lt;/div>
                        &lt;/div>`;
        }

        var s = `&lt;div class="accordion accordion-flush" id="reportCriteriaAccordion">
                  ${sCriterias}  
                &lt;/div>`;

        $('#' + this.id + '_criteriasBody').html(s);

        /**
         * Load JS code for components
         */
        for (var x in aCriterias) {
            aCriterias[x].initializeJS();
        }
        this.app.viewer.criterias = aCriterias;

        this._reportCriteriasRendered = true;


    }


    /**
     * Applies criteria values to report
     */
    applyCriterias() {

        this.hideReportCriterias();
        this.app.viewer.refreshReport();
    }

    /**
     * Displays report criteria section
     */
    showReportCriterias() {

        this._initialCriteriaValues = this.app.viewer.getCriteriaValues();

        $('#' + this.id + '_canvas').hide();
        $('#' + this.id + '_criteriasZone').show();
    }

    /**
     * Hides report criteria section
     */
    hideReportCriterias() {

        $('#' + this.id + '_criteriasZone').hide();
        $('#' + this.id + '_canvas').show();
    }

    /**
     * Cancels report criterias, does not apply changes
     */
    cancelCriterias() {
        if (JSON.stringify(this._initialCriteriaValues) != JSON.stringify(this.app.viewer.getCriteriaValues())) {
            // Criteria values have changed, confirm?
            // @todo reset criterias
        }

        this.hideReportCriterias();
    }

    /**
     * Reset criteria values to original values
     */
    resetCriterias() {
        if (JSON.stringify(this._initialCriteriaValues) != JSON.stringify(this.app.viewer.getCriteriaValues())) {
            // Criteria values have changed, confirm?
            // @todo reset criterias
        }

        this.hideReportCriterias();
    }

    /**
     * Makes a copy of original settings and criteria values
     * Used to reset properties of report
     */
    copyOriginalSettings() {
        this._initialCriteriaValues = this.app.viewer.getCriteriaValues();
        this._initialReportSettings = {
            sections: [],
        }
        for (var x in this.getReportDefinition().sections) {
            var oSection = this.getReportDefinition().sections[x];
            this._initialReportSettings['sections'] = {
                id: oSection.id,
                properties: JSON.parse(JSON.stringify(oSection.properties)),
                orderBy: JSON.parse(JSON.stringify(oSection.orderBy)),
                groupBy: JSON.parse(JSON.stringify(oSection.groupBy)),
                model: JSON.parse(JSON.stringify(oSection.model)),
            }
        }
    }

    getReportSections() {

        return this.getReportDefinition().sections;

    }

    getReportSection(id) {

        for (var x in this.getReportDefinition().sections) {
            if (this.getReportDefinition().sections[x].id == id) {
                return this.getReportDefinition().sections[x];
            }
        }

        return null;

    }




}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Thu Dec 29 2022 18:40:26 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
